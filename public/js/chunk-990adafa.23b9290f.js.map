{"version":3,"sources":["webpack:///./node_modules/core-js/modules/_array-methods.js","webpack:///./node_modules/core-js/modules/_is-array.js","webpack:///./node_modules/core-js/modules/es6.array.find-index.js","webpack:///./src/views/chat-module/groupChat.vue?b1ff","webpack:///./src/views/chat-module/groupChat.vue?3f41","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck.js","webpack:///./node_modules/@babel/runtime-corejs2/helpers/esm/createClass.js","webpack:///./src/utils/robot.js","webpack:///src/views/chat-module/groupChat.vue","webpack:///./src/views/chat-module/groupChat.vue?7397","webpack:///./src/views/chat-module/groupChat.vue","webpack:///./node_modules/core-js/modules/_array-species-create.js","webpack:///./node_modules/core-js/modules/_array-species-constructor.js"],"names":["ctx","__webpack_require__","IObject","toObject","toLength","asc","module","exports","TYPE","$create","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","create","$this","callbackfn","that","val","res","O","self","f","length","index","result","undefined","push","cof","Array","isArray","arg","$export","$find","KEY","forced","P","F","findIndex","this","arguments","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_groupChat_vue_vue_type_style_index_0_id_066db5e0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_groupChat_vue_vue_type_style_index_0_id_066db5e0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","id","separator-class","to","path","_v","_l","user","key","src","avatarURL","_s","name","directives","rawName","value","expression","placeholder","domProps","on","input","$event","target","composing","joinUserId","click","joinRoom","curRoom","ref","message","class","senderId","userId","userAvatars","userNames","text","attachment","_e","clickSendMessage","staticRenderFns","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","i","descriptor","enumerable","configurable","writable","define_property_default","_createClass","protoProps","staticProps","prototype","Robot","apiKey","sendMessageToRobot","http","get","concat","robot","groupChatvue_type_script_lang_js_","data","messages","isRobotRoom","users","computed","Object","objectSpread","vuex_esm","currentUser","chatUser","userInfo","avatars","len","names","filters","created","_this","$route","params","room","customData","getMessage","subscribeToRoom","roomId","hooks","onMessage","onUserJoined","onUserLeft","messageLimit","then","console","log","catch","err","methods","_this2","fetchMessages","direction","limit","viewToBottom","sendMessage","_this3","receiveMessage","type","sendImageMessage","imageUrl","_this4","$nextTick","$refs","scrollView","scrollTop","scrollHeight","_this5","addUserToRoom","getAvatar","idx","beforeDestory","roomSubscriptions","cancel","chat_module_groupChatvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","speciesConstructor","original","isObject","SPECIES","C","constructor"],"mappings":"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","file":"js/chunk-990adafa.23b9290f.js","sourcesContent":["// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupChat.vue?vue&type=style&index=0&id=066db5e0&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupChat.vue?vue&type=style&index=0&id=066db5e0&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-container\",attrs:{\"id\":\"chat-wrapper\"}},[_c('el-breadcrumb',{staticClass:\"breadcrumb\",attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: 'chatRoom' }}},[_vm._v(\"房间列表\")]),_c('el-breadcrumb-item',[_vm._v(\"聊天页\")])],1),_c('div',{staticClass:\"main-container\"},[_c('div',{staticClass:\"user-con\"},[_c('div',[_vm._v(\"房间成员：\")]),_c('ul',_vm._l((_vm.users),function(user){return _c('li',{key:user.id,staticClass:\"user-item\"},[_c('img',{attrs:{\"src\":user.avatarURL}}),_c('span',[_vm._v(_vm._s(user.name))])])}),0),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.joinUserId),expression:\"joinUserId\"}],attrs:{\"placeholder\":\"enter user account\"},domProps:{\"value\":(_vm.joinUserId)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.joinUserId=$event.target.value}}}),_c('button',{staticClass:\"join-btn\",on:{\"click\":_vm.joinRoom}},[_vm._v(\"邀请加入房间\")])]),_c('div',{staticClass:\"chat-content\"},[_c('div',{staticClass:\"chat-content-hd\"},[_vm._v(_vm._s(_vm.curRoom.name))]),_c('div',{ref:\"scrollView\",staticClass:\"chat-content-bd\"},[_c('ul',_vm._l((_vm.messages),function(message,index){return _c('li',{key:index,class:message.senderId===_vm.userId ? 'chat-message-right':'chat-message-left'},[_c('img',{staticClass:\"chat-avatar\",attrs:{\"src\":_vm.userAvatars[message.senderId]}}),_c('div',{staticClass:\"chat-message\"},[_c('p',{staticClass:\"chat-name\"},[_vm._v(_vm._s(_vm.userNames[message.senderId]))]),(message.text)?_c('p',{staticClass:\"chat-text\"},[_vm._v(_vm._s(message.text))]):(message.attachment)?_c('img',{staticClass:\"chat-image\",attrs:{\"src\":message.attachment}}):_vm._e()])])}),0)]),_c('div',{staticClass:\"chat-content-ft\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"placeholder\":\"enter your mseeage ...\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('button',{on:{\"click\":_vm.clickSendMessage}},[_vm._v(\"send message\")])])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import _Object$defineProperty from \"../../core-js/object/define-property\";\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n\n    _Object$defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import http from '@/utils/http'\n// const url = 'http://www.tuling123.com/openapi/api?key=你申请的key&info=你要发的消息';\nclass Robot {\n    constructor(apiKey) {\n        this.apiKey = apiKey;\n    }\n    chatTo(user) {\n        user.sendMessageToRobot = function (message) {\n            return http.get(`http://www.tuling123.com/openapi/api?key=${this.apiKey}&info=${message}`);\n        }\n    }\n    receiveMessage(message) {\n        return http.get(`http://www.tuling123.com/openapi/api?key=${this.apiKey}&info=${message}`);\n    }\n}\n\nexport default new Robot('ac7b6152eb2047a1b7e45678bca5b545');","<template>\n  <div id=\"chat-wrapper\" class=\"page-container\">\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\" class=\"breadcrumb\">\n      <el-breadcrumb-item :to=\"{ path: 'chatRoom' }\">房间列表</el-breadcrumb-item>\n      <el-breadcrumb-item>聊天页</el-breadcrumb-item>\n    </el-breadcrumb>\n    <div class=\"main-container\">\n      <div class=\"user-con\">\n        <div>房间成员：</div>\n        <ul>\n          <li v-for=\"user in users\" :key=\"user.id\" class=\"user-item\">\n            <img :src=\"user.avatarURL\">\n            <span>{{user.name}}</span>\n          </li>\n        </ul>\n        <input placeholder=\"enter user account\" v-model=\"joinUserId\">\n        <button class=\"join-btn\" @click=\"joinRoom\">邀请加入房间</button>\n      </div>\n      <div class=\"chat-content\">\n        <div class=\"chat-content-hd\">{{curRoom.name}}</div>\n        <div class=\"chat-content-bd\" ref=\"scrollView\">\n          <ul>\n            <li\n              v-for=\"(message, index) in messages\"\n              :key=\"index\"\n              :class=\"message.senderId===userId ? 'chat-message-right':'chat-message-left'\"\n            >\n              <!-- 用户头像 -->\n              <img class=\"chat-avatar\" :src=\"userAvatars[message.senderId]\">\n              <!-- 用户昵称 -->\n              <div class=\"chat-message\">\n                <p class=\"chat-name\">{{userNames[message.senderId]}}</p>\n                <!-- 内容 -->\n                <p v-if=\"message.text\" class=\"chat-text\">{{message.text}}</p>\n                <!-- 图片 -->\n                <img v-else-if=\"message.attachment\" class=\"chat-image\" :src=\"message.attachment\">\n                <!-- 系统消息 -->\n                <!-- <span v-else-if=\"message.type==='3'\" class=\"chat-system-text\">{{message.content}}</span> -->\n                <!-- 未知对象 -->\n                <!-- <span v-else class=\"chat-unknow-text\">{{message.content}}</span> -->\n              </div>\n            </li>\n          </ul>\n        </div>\n        <div class=\"chat-content-ft\">\n          <input placeholder=\"enter your mseeage ...\" v-model=\"message\">\n          <button @click=\"clickSendMessage\">send message</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport robot from \"@/utils/robot\";\nexport default {\n  data() {\n    return {\n      messages: [],\n      message: \"\",\n      isRobotRoom: false,\n      curRoom: {},\n      joinUserId: \"\",\n      users: []\n    };\n  },\n  computed: {\n    ...mapGetters([\"user\"]),\n    currentUser() {\n      return this.user.chatUser;\n    },\n    userId() {\n      return this.user.userInfo.id;\n    },\n    userAvatars() {\n      const avatars = {};\n      let user = {};\n      const len = this.users.length;\n      for (let i = 0; i < len; i++) {\n        user = this.users[i];\n        avatars[user.id] = user.avatarURL;\n      }\n      return avatars;\n    },\n    userNames() {\n      const names = {};\n      let user = {};\n      const len = this.users.length;\n      for (let i = 0; i < len; i++) {\n        user = this.users[i];\n        names[user.id] = user.name;\n      }\n      return names;\n    }\n  },\n  filters: {},\n  created() {\n    this.curRoom = this.$route.params.room || {};\n    this.isRobotRoom =\n      this.curRoom.customData && this.curRoom.customData.isRobotRoom;\n    // 机器人聊天室，不接入chatkit，无聊天消息\n    if (this.curRoom.id) {\n      this.getMessage();\n      this.currentUser\n        .subscribeToRoom({\n          roomId: this.curRoom.id,\n          hooks: {\n            onMessage: message => {\n              const { id, senderId, attachment, text } = message;\n              if (senderId !== this.userId) {\n                // 自己发的消息，本地先发送\n                this.messages.push({\n                  senderId,\n                  attachment, //attachment为图片地址，默认优先判断\n                  text,\n                  id\n                });\n              }\n            },\n            onUserJoined: () => {},\n            onUserLeft: () => {}\n          },\n          messageLimit: 10\n        })\n        .then(room => {\n          this.users = room.users;\n          console.log(this.users);\n        })\n        .catch(err => console.log(err));\n    }\n  },\n  methods: {\n    getMessage() {\n      if (this.isRobotRoom) {\n        return;\n      }\n      this.currentUser\n        .fetchMessages({\n          roomId: this.curRoom.id,\n          // initialId: 42,\n          direction: \"older\",\n          limit: 30\n        })\n        .then(messages => {\n          this.messages = messages;\n          this.viewToBottom();\n          // do something with the messages\n        })\n        .catch(err => {\n          console.log(`Error fetching messages: ${err}`);\n        });\n    },\n    clickSendMessage() {\n      if (this.isRobotRoom) {\n        this.sendMessageToRobot();\n      } else {\n        this.sendMessage();\n      }\n    },\n    sendMessageToRobot() {\n      this.messages.push({\n        senderId: this.userId,\n        text: this.message\n      });\n      this.viewToBottom();\n      // 机器人\n      robot\n        .receiveMessage(this.message)\n        .then(res => {\n          this.messages.push({\n            text: res.text,\n            senderId: \"ROBOT\"\n          });\n          this.viewToBottom();\n        })\n        .catch(() => {\n          this.messages.push({\n            text: \"robot is gone!\",\n            type: \"3\"\n          });\n        });\n      this.message = \"\";\n    },\n    sendMessage() {\n      this.messages.push({\n        senderId: this.userId,\n        text: this.message\n      });\n      this.viewToBottom();\n      this.currentUser\n        .sendMessage({\n          text: this.message,\n          roomId: this.curRoom.id\n        })\n        .then((/*messageId*/) => {\n          // console.log(`Added message to ${myRoom.name}`);\n        })\n        .catch(() => {\n          // console.log(`Error adding message to ${myRoom.name}: ${err}`);\n        });\n      this.message = \"\";\n    },\n    sendImageMessage(imageUrl) {\n      this.messages.push({\n        senderId: this.userId,\n        attachment: imageUrl\n      });\n    },\n    viewToBottom() {\n      this.$nextTick(() => {\n        if (this.$refs.scrollView) {\n          this.$refs.scrollView.scrollTop = this.$refs.scrollView.scrollHeight;\n        }\n      });\n    },\n    joinRoom() {\n      this.currentUser\n        .addUserToRoom({\n          userId: this.joinUserId,\n          roomId: this.curRoom.id\n        })\n        .then(room => {\n          this.curRoom = room;\n          // this.users = room.users;\n        })\n        .catch(() => {});\n      this.joinUserId = \"\";\n    },\n    getAvatar(userId) {\n      // debugger;\n      const idx = this.users.findIndex(user => user.id === userId);\n      if (idx > -1) {\n        console.log(this.users[idx].avatarURL, \"avatarURL\");\n        return this.users[idx].avatarURL;\n      } else {\n        return \"\";\n      }\n    }\n  },\n  beforeDestory() {\n    this.curRoom.id &&\n      this.currentUser.roomSubscriptions[this.curRoom.id].cancel();\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.breadcrumb {\n  max-width: 1200px;\n  margin: 10px auto 20px;\n}\n.main-container {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n}\n.join-btn {\n  margin-top: 16px;\n}\n.user-con {\n  margin-bottom: 20px;\n  .user-item {\n    padding: 2px 0px;\n    display: flex;\n    align-items: center;\n    img {\n      width: 30px;\n      margin-right: 8px;\n    }\n  }\n}\n.chat-content {\n  max-width: 750px;\n  width: 100%;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  // margin-top: 30px;\n  display: flex;\n  flex-direction: column;\n  background-color: aliceblue;\n  .chat-content-hd {\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .chat-content-bd {\n    flex-grow: 1;\n    max-height: 430px;\n    min-height: 200px;\n    overflow: auto;\n    padding: 20px;\n    ul li {\n      display: flex;\n      align-items: center;\n      padding: 12px 0px;\n    }\n    .chat-message-left {\n      .chat-text::before {\n        left: -20px;\n        border-right-color: #91d98a;\n      }\n    }\n    .chat-message-right {\n      flex-direction: row-reverse;\n      .chat-text::before {\n        right: -20px;\n        border-left-color: #91d98a;\n      }\n      .chat-name {\n        text-align: right;\n      }\n    }\n    .chat-message {\n      margin: 0 16px;\n    }\n    .chat-name {\n      margin: 0px;\n      font-size: 12px;\n    }\n    .chat-text {\n      position: relative;\n      background-color: #91d98a;\n      border-radius: 4px;\n      padding: 10px 20px;\n      margin: 0px;\n      color: #fff;\n      &::before {\n        content: \" \";\n        display: block;\n        width: 0;\n        height: 0;\n        border: 12px solid transparent;\n        top: 8px;\n        position: absolute;\n        z-index: 2;\n      }\n    }\n    .chat-avatar {\n      width: 50px;\n      // margin-right: 16px;\n      border-radius: 50%;\n    }\n  }\n  .chat-content-ft {\n    height: 40px;\n    display: flex;\n    padding: 6px 20px;\n    input {\n      flex: auto;\n      padding-left: 8px;\n    }\n  }\n}\n</style>\n\n\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupChat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./groupChat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./groupChat.vue?vue&type=template&id=066db5e0&scoped=true&\"\nimport script from \"./groupChat.vue?vue&type=script&lang=js&\"\nexport * from \"./groupChat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./groupChat.vue?vue&type=style&index=0&id=066db5e0&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"066db5e0\",\n  null\n  \n)\n\nexport default component.exports","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n"],"sourceRoot":""}